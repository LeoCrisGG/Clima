<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/PROBLEMAS_RESUELTOS.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/PROBLEMAS_RESUELTOS.md" />
              <option name="originalContent" value="#  Problemas Resueltos y Explicaciones&#10;&#10;##  1. ¿Por qué aparece &quot;Monteros&quot; en lugar de &quot;Castilla&quot;?&#10;&#10;### **Explicación del Problema:**&#10;&#10;OpenWeatherMap API funciona con una base de datos de ciudades registradas. Cuando obtienes el clima por **coordenadas GPS**, la API busca en su base de datos la ciudad más cercana a esas coordenadas.&#10;&#10;**El problema es:**&#10;- Tu ubicación GPS puede estar en &quot;Castilla&quot;, pero en la base de datos de OpenWeatherMap, la ciudad registrada más cercana es &quot;Monteros&quot;&#10;- Esto es común en zonas rurales, pueblos pequeños, o áreas entre ciudades&#10;- La API de OpenWeatherMap tiene un número limitado de ciudades en su base de datos&#10;&#10;### **Soluciones:**&#10;&#10;#### **Opción 1: Buscar por nombre (Recomendado)**&#10;En lugar de usar tu ubicación GPS, busca directamente &quot;Castilla&quot; en el buscador de la app. Esto te dará los datos exactos de Castilla si está en la base de datos de OpenWeatherMap.&#10;&#10;#### **Opción 2: Usar el Mapa**&#10;Ve a la pestaña del mapa y selecciona manualmente un punto más cercano al centro de Castilla. Esto puede dar resultados diferentes.&#10;&#10;#### **Opción 3: Aceptar el nombre que da la API**&#10;Es técnicamente correcto que use &quot;Monteros&quot; si las coordenadas de tu GPS están más cerca de esa ciudad registrada. Los datos del clima serán igualmente precisos para tu área.&#10;&#10;### **Nota Técnica:**&#10;OpenWeatherMap tiene ~200,000 ciudades en su base de datos global. No todas las localidades pequeñas están incluidas. Si buscas &quot;Castilla&quot; y no aparece, significa que no está registrada en su sistema.&#10;&#10;---&#10;&#10;## ️ 2. ¿Por qué no carga el mapa?&#10;&#10;### **Causa del Problema:**&#10;&#10;El mapa de Google Maps necesita una **API Key válida** para funcionar. Si el mapa se ve:&#10;- **Gris/Vacío**: La API key no está configurada o es inválida&#10;- **Con mensaje de error**: La API no está habilitada o excediste el límite&#10;- **Sin marcadores**: Problema de permisos de ubicación&#10;&#10;### **Solución Paso a Paso:**&#10;&#10;#### **1. Obtén tu Google Maps API Key:**&#10;&#10;1. Ve a: https://console.cloud.google.com/&#10;2. Crea un proyecto nuevo (o usa uno existente)&#10;3. Ve a &quot;APIs &amp; Services&quot; &gt; &quot;Library&quot;&#10;4. Busca y habilita:&#10;   - **Maps SDK for Android**&#10;   - **Places API** (opcional, pero recomendado)&#10;5. Ve a &quot;APIs &amp; Services&quot; &gt; &quot;Credentials&quot;&#10;6. Crea una &quot;API Key&quot;&#10;7. **IMPORTANTE**: Restringe la key solo a tu app (por seguridad)&#10;&#10;#### **2. Configura la API Key en tu proyecto:**&#10;&#10;Abre el archivo `local.properties` (en la raíz del proyecto) y agrega:&#10;&#10;```properties&#10;GOOGLE_MAPS_API_KEY=AIzaSy... (tu key real aquí)&#10;OPENWEATHER_API_KEY=tu_key_de_openweather&#10;```&#10;&#10;#### **3. Sincroniza el proyecto:**&#10;&#10;En Android Studio:&#10;- Clic en &quot;Sync Now&quot; cuando aparezca el banner&#10;- O: `File &gt; Sync Project with Gradle Files`&#10;&#10;#### **4. Ejecuta de nuevo:**&#10;&#10;Desinstala la app del dispositivo y vuelve a instalarla para que tome la nueva configuración.&#10;&#10;### **Verificación:**&#10;&#10;Si todo está correcto, deberías ver:&#10;- ✅ El mapa de Google con calles y ubicaciones&#10;- ✅ Un marcador donde toques&#10;- ✅ Controles de zoom funcionando&#10;&#10;### **Límites de la API:**&#10;&#10;Google Maps es **GRATIS** hasta:&#10;- 28,000 cargas de mapa por mes&#10;- $200 USD de crédito gratis cada mes&#10;&#10;Para una app personal, nunca llegarás al límite.&#10;&#10;---&#10;&#10;## ⭐ 3. Prevención de Favoritos Duplicados (RESUELTO)&#10;&#10;### **Problema anterior:**&#10;Podías agregar la misma ciudad múltiples veces a favoritos.&#10;&#10;### **Solución implementada:**&#10;&#10;Ahora el sistema:&#10;1. **Verifica antes de agregar**: Comprueba si la ciudad ya existe en favoritos&#10;2. **Muestra mensaje claro**: &quot;⚠️ Esta ciudad ya está en tus favoritos&quot;&#10;3. **Compara por nombre**: Dos ubicaciones con el mismo nombre de ciudad se consideran duplicadas&#10;&#10;### **Código agregado:**&#10;```kotlin&#10;// En WeatherViewModel.kt&#10;fun addToFavorites(location: FavoriteLocation) {&#10;    viewModelScope.launch {&#10;        val isFav = repository.isFavorite(location.cityName)&#10;        if (isFav) {&#10;            _uiState.update {&#10;                it.copy(error = &quot;⚠️ Esta ciudad ya está en tus favoritos&quot;)&#10;            }&#10;            return@launch&#10;        }&#10;        // ... resto del código&#10;    }&#10;}&#10;```&#10;&#10;---&#10;&#10;##  4. Sugerencias de Búsqueda (NUEVO)&#10;&#10;### **Funcionalidad implementada:**&#10;&#10;Ahora mientras escribes en el buscador:&#10;- A partir de **2 caracteres**, aparecen sugerencias&#10;- Lista de **más de 80 ciudades** populares de España y Latinoamérica&#10;- Búsqueda **en tiempo real** mientras escribes&#10;- Filtra por coincidencias en el nombre de la ciudad&#10;&#10;### **Ciudades incluidas:**&#10;&#10;#### España:&#10;Madrid, Barcelona, Valencia, Sevilla, Zaragoza, Málaga, Murcia, Palma, Las Palmas, Bilbao, Alicante, Córdoba, Valladolid, Vigo, Gijón, Granada, Vitoria, Elche, Oviedo, Cartagena, Jerez, Sabadell, Almería, Pamplona, Castellón, Burgos, Santander, San Sebastián, Salamanca, Albacete, Logroño, León, Badajoz, Cádiz, Huelva, Tarragona, Lleida, Marbella&#10;&#10;#### Latinoamérica:&#10;Buenos Aires, Córdoba (AR), Rosario, Mendoza, México City, Guadalajara, Monterrey, Lima, Arequipa, Bogotá, Medellín, Cali, Santiago, Quito, Guayaquil, Caracas, La Paz, Montevideo, Asunción, San José, Panamá, Guatemala, San Salvador, Tegucigalpa, Managua, San Juan, Santo Domingo, La Habana, y más...&#10;&#10;### **Cómo funciona:**&#10;&#10;```kotlin&#10;// En WeatherRepository.kt&#10;fun searchCities(query: String): Result&lt;List&lt;String&gt;&gt; {&#10;    if (query.length &lt; 2) {&#10;        return Result.success(emptyList())&#10;    }&#10;    &#10;    val suggestions = getCitySuggestions(query)&#10;    return Result.success(suggestions)&#10;}&#10;```&#10;&#10;El sistema filtra las ciudades que contienen el texto que escribes y muestra las primeras 5 coincidencias.&#10;&#10;---&#10;&#10;##  Resumen de Mejoras Implementadas&#10;&#10;### ✅ **Validación de Favoritos**&#10;- No se pueden agregar ciudades duplicadas&#10;- Mensajes claros de error&#10;- Límite de 5 favoritos con contador visible&#10;&#10;### ✅ **Sistema de Sugerencias**&#10;- Búsqueda en tiempo real&#10;- Base de datos de 80+ ciudades&#10;- Respuesta instantánea (sin llamadas a API)&#10;&#10;### ✅ **Mejor UX**&#10;- Mensajes informativos para cada acción&#10;- Emojis para identificar rápidamente el estado&#10;- Animaciones suaves y transiciones&#10;&#10;### ✅ **Documentación Completa**&#10;- Explicación del problema de nombres de ciudades&#10;- Guía completa para configurar Google Maps&#10;- Solución de problemas comunes&#10;&#10;---&#10;&#10;##  Cómo Usar la App Actualizada&#10;&#10;1. **Primera vez:**&#10;   - Acepta los permisos de ubicación&#10;   - Se carga automáticamente el clima de tu ubicación actual&#10;&#10;2. **Buscar ciudades:**&#10;   - Escribe al menos 2 letras&#10;   - Aparecerán sugerencias automáticamente&#10;   - Selecciona una o presiona el botón de buscar&#10;&#10;3. **Agregar favoritos:**&#10;   - Presiona la ⭐ en la tarjeta del clima&#10;   - Máximo 5 ciudades&#10;   - No se permiten duplicados&#10;&#10;4. **Usar el mapa:**&#10;   - Ve a la pestaña &quot;Mapa&quot;&#10;   - Toca cualquier lugar del mapa&#10;   - Presiona &quot;Ver clima de esta ubicación&quot;&#10;   - Automáticamente te lleva a la vista del clima&#10;&#10;5. **Cambiar entre favoritos:**&#10;   - Toca cualquier tarjeta de favoritos&#10;   - Se carga instantáneamente el clima de esa ubicación&#10;&#10;---&#10;&#10;## ❓ Preguntas Frecuentes&#10;&#10;### **P: ¿Por qué el clima de mi ubicación no es exacto?**&#10;R: El GPS puede tener un margen de error de 5-50 metros. Para mayor precisión, busca tu ciudad por nombre.&#10;&#10;### **P: ¿Puedo agregar más de 5 favoritos?**&#10;R: No, el límite es 5 para mantener la interfaz limpia y rápida.&#10;&#10;### **P: ¿Las sugerencias funcionan offline?**&#10;R: Sí, las sugerencias están en el código. Pero para obtener el clima necesitas conexión a internet.&#10;&#10;### **P: ¿Por qué algunas ciudades pequeñas no aparecen?**&#10;R: OpenWeatherMap tiene ~200,000 ciudades. Si tu ciudad no está, usa las coordenadas del mapa.&#10;&#10;### **P: ¿Cuánto cuestan las APIs?**&#10;R: OpenWeatherMap Free Plan: GRATIS hasta 1,000,000 llamadas/mes&#10;   Google Maps: GRATIS con $200 USD crédito mensual&#10;&#10;---&#10;&#10;##  Soporte&#10;&#10;Si tienes más problemas:&#10;1. Verifica que las API keys estén correctamente en `local.properties`&#10;2. Sincroniza Gradle después de cualquier cambio&#10;3. Desinstala y reinstala la app si cambiaste las keys&#10;4. Verifica los permisos de ubicación en la configuración del dispositivo&#10;&#10;---&#10;&#10;**Última actualización:** Enero 2026&#10;**Versión de la app:** 1.0&#10;&#10;" />
              <option name="updatedContent" value="#  Problemas Resueltos y Explicaciones&#10;&#10;##  NUEVA SECCIÓN: Arquitectura del Código y Explicación Detallada&#10;&#10;### **¿Cómo está organizado el código?**&#10;&#10;La aplicación sigue el patrón **MVVM (Model-View-ViewModel)** que es el estándar recomendado por Google para apps Android modernas.&#10;&#10;#### **️ Capas de la Arquitectura:**&#10;&#10;```&#10;┌─────────────────────────────────────┐&#10;│         UI (View Layer)              │&#10;│  - WeatherScreen.kt                  │&#10;│  - MapScreen.kt                      │&#10;│  - MainActivity.kt                   │&#10;└──────────────┬──────────────────────┘&#10;               │ Observa StateFlow&#10;               ▼&#10;┌─────────────────────────────────────┐&#10;│    ViewModel Layer                   │&#10;│  - WeatherViewModel.kt               │&#10;│    • Maneja la lógica de negocio    │&#10;│    • Mantiene el estado de la UI    │&#10;│    • Ejecuta operaciones asíncronas │&#10;└──────────────┬──────────────────────┘&#10;               │ Llama funciones&#10;               ▼&#10;┌─────────────────────────────────────┐&#10;│    Repository Layer                  │&#10;│  - WeatherRepository.kt              │&#10;│    • Coordina fuentes de datos      │&#10;│    • Maneja caché y lógica de datos │&#10;│    • Mapea nombres de ciudades      │&#10;└──────────────┬──────────────────────┘&#10;               │ Obtiene datos&#10;               ▼&#10;┌─────────────────────────────────────┐&#10;│    Data Sources                      │&#10;│  - WeatherApiService (Retrofit)     │&#10;│  - FavoriteLocationDao (Room DB)    │&#10;└─────────────────────────────────────┘&#10;```&#10;&#10;#### ** Explicación de Archivos Principales:**&#10;&#10;##### **1. MainActivity.kt** (Punto de Entrada)&#10;**Responsabilidad:** Configurar la aplicación y manejar la navegación principal.&#10;&#10;**Funciones clave:**&#10;- `onCreate()`: Inicializa la app con Jetpack Compose&#10;- `WeatherApp()`: Composable principal con Scaffold (barras, navegación)&#10;- Maneja permisos de ubicación con Accompanist&#10;- Controla pestañas (Clima / Mapa)&#10;- Conecta UI con ViewModel mediante callbacks&#10;&#10;**Flujo de interacción:**&#10;1. Usuario interactúa con la UI (ej: hace clic en buscar)&#10;2. MainActivity llama a una función del ViewModel&#10;3. ViewModel procesa y actualiza el estado&#10;4. MainActivity observa el cambio y actualiza la UI&#10;&#10;##### **2. WeatherViewModel.kt** (Lógica de Negocio)&#10;**Responsabilidad:** Manejar el estado de la aplicación y coordinar operaciones.&#10;&#10;**Componentes importantes:**&#10;- `WeatherUiState`: Data class que contiene TODO el estado de la UI&#10;- `StateFlow`: Observable que emite cambios de estado a la UI&#10;- Funciones públicas que la UI puede llamar:&#10;  - `getWeatherByCoordinates()`: Obtener clima por GPS&#10;  - `searchCity()`: Buscar ciudad por nombre&#10;  - `updateSearchQuery()`: Actualizar búsqueda en tiempo real&#10;  - `addToFavorites()`: Agregar a favoritos con validación&#10;  - `removeFromFavorites()`: Eliminar favorito&#10;&#10;**¿Por qué usar ViewModel?**&#10;- Sobrevive a rotaciones de pantalla&#10;- Separa lógica de la UI&#10;- Maneja operaciones asíncronas de forma segura&#10;- Usa coroutines para no bloquear la UI&#10;&#10;##### **3. WeatherRepository.kt** (Coordinador de Datos)&#10;**Responsabilidad:** Intermediario entre ViewModel y fuentes de datos.&#10;&#10;**Funciones principales:**&#10;- `getWeatherByCoordinates()`: Llama a la API con coordenadas&#10;- `getWeatherByCity()`: Llama a la API con nombre de ciudad&#10;- `mapCityName()`: Reemplaza nombres (Monteros → Castilla)&#10;- `searchCities()`: Filtra sugerencias (offline, sin API)&#10;- `addFavorite()`: Valida y guarda en base de datos&#10;- `getAllFavorites()`: Retorna Flow que observa cambios en BD&#10;&#10;**Ventajas del Repository:**&#10;- Si cambias la API, solo modificas el Repository&#10;- Puede combinar múltiples fuentes (API + BD + Cache)&#10;- Lógica de negocio centralizada&#10;&#10;##### **4. WeatherScreen.kt** (Interfaz de Usuario)&#10;**Responsabilidad:** Mostrar datos y capturar interacciones del usuario.&#10;&#10;**Componentes principales:**&#10;- `SearchBarWithSuggestions`: Buscador con autocomplete&#10;- `FavoriteCard`: Tarjetas de ubicaciones favoritas&#10;- `AnimatedWeatherInfoCard`: Tarjeta principal con clima actual&#10;- `EnhancedWeatherDetailsCard`: Temperaturas máx/mín&#10;- `EnhancedAdditionalInfoCard`: Detalles (humedad, viento, etc.)&#10;&#10;**Patrón de diseño:**&#10;- Composables reciben datos como parámetros&#10;- Composables llaman callbacks para acciones&#10;- Sin lógica de negocio, solo presentación&#10;- Fácil de probar y reutilizar&#10;&#10;---&#10;&#10;### ** Flujo Completo de una Búsqueda:**&#10;&#10;#### Ejemplo: Usuario busca &quot;Madrid&quot;&#10;&#10;**Paso 1: Usuario escribe &quot;Mad&quot;**&#10;```kotlin&#10;// MainActivity.kt&#10;onSearchQueryChange = { viewModel.updateSearchQuery(it) }&#10;```&#10;&#10;**Paso 2: ViewModel procesa la entrada**&#10;```kotlin&#10;// WeatherViewModel.kt&#10;fun updateSearchQuery(query: String) {&#10;    _uiState.update { it.copy(searchQuery = query) }&#10;    &#10;    if (query.length &gt;= 2) {  // Mínimo 2 caracteres&#10;        val result = repository.searchCities(query)&#10;        // Actualizar sugerencias&#10;    }&#10;}&#10;```&#10;&#10;**Paso 3: Repository filtra sugerencias**&#10;```kotlin&#10;// WeatherRepository.kt&#10;fun searchCities(query: String): Result&lt;List&lt;String&gt;&gt; {&#10;    val suggestions = getCitySuggestions(query)&#10;    // Retorna: [&quot;Madrid&quot;, &quot;Maracaibo&quot;, ...]&#10;    return Result.success(suggestions)&#10;}&#10;```&#10;&#10;**Paso 4: ViewModel actualiza el estado**&#10;```kotlin&#10;_uiState.update {&#10;    it.copy(&#10;        citySuggestions = [&quot;Madrid&quot;, &quot;Maracaibo&quot;],&#10;        showSuggestions = true&#10;    )&#10;}&#10;```&#10;&#10;**Paso 5: UI se actualiza automáticamente**&#10;```kotlin&#10;// WeatherScreen.kt&#10;SearchBarWithSuggestions(&#10;    searchText = searchQuery,           // &quot;Mad&quot;&#10;    suggestions = citySuggestions,       // [&quot;Madrid&quot;, &quot;Maracaibo&quot;]&#10;    showSuggestions = showSuggestions,   // true&#10;    // ... muestra el dropdown&#10;)&#10;```&#10;&#10;**Paso 6: Usuario hace clic en &quot;Madrid&quot;**&#10;```kotlin&#10;// MainActivity.kt&#10;onSuggestionClick = { suggestion -&gt;&#10;    viewModel.searchCity(suggestion)  // &quot;Madrid&quot;&#10;}&#10;```&#10;&#10;**Paso 7: ViewModel llama a la API**&#10;```kotlin&#10;// WeatherViewModel.kt&#10;fun searchCity(cityName: String) {&#10;    val result = repository.getWeatherByCity(cityName)&#10;    // Llamada HTTP a OpenWeatherMap&#10;}&#10;```&#10;&#10;**Paso 8: Repository obtiene datos**&#10;```kotlin&#10;// WeatherRepository.kt&#10;suspend fun getWeatherByCity(cityName: String): Result&lt;WeatherResponse&gt; {&#10;    val response = weatherApi.getCurrentWeatherByCity(cityName, apiKey)&#10;    val mappedResponse = response.copy(name = mapCityName(response.name))&#10;    return Result.success(mappedResponse)&#10;}&#10;```&#10;&#10;**Paso 9: ViewModel actualiza con los datos del clima**&#10;```kotlin&#10;_uiState.update {&#10;    it.copy(&#10;        weatherData = weather,     // Datos de Madrid&#10;        searchQuery = &quot;&quot;,          // RESETEAR campo&#10;        showSuggestions = false    // Ocultar dropdown&#10;    )&#10;}&#10;```&#10;&#10;**Paso 10: UI muestra el clima de Madrid**&#10;```kotlin&#10;// WeatherScreen.kt&#10;AnimatedWeatherInfoCard(&#10;    weather = weatherData,  // 15°C, soleado, etc.&#10;    // ... se renderiza&#10;)&#10;```&#10;&#10;---&#10;&#10;### ** ¿Cómo funciona la Base de Datos de Favoritos?**&#10;&#10;Usamos **Room** (SQLite con Kotlin) para almacenar favoritos localmente.&#10;&#10;#### **Flujo de agregar favorito:**&#10;&#10;1. **Usuario hace clic en ⭐**&#10;   ```kotlin&#10;   // MainActivity.kt&#10;   onAddFavorite = {&#10;       val favorite = FavoriteLocation(&#10;           cityName = &quot;Madrid&quot;,&#10;           latitude = 40.4168,&#10;           longitude = -3.7038,&#10;           country = &quot;ES&quot;&#10;       )&#10;       viewModel.addToFavorites(favorite)&#10;   }&#10;   ```&#10;&#10;2. **ViewModel valida duplicados**&#10;   ```kotlin&#10;   // WeatherViewModel.kt&#10;   val isFav = repository.isFavorite(location.cityName)&#10;   if (isFav) {&#10;       // Error: ya existe&#10;       return&#10;   }&#10;   ```&#10;&#10;3. **Repository guarda en BD**&#10;   ```kotlin&#10;   // WeatherRepository.kt&#10;   favoriteLocationDao.insertFavorite(location)&#10;   // Se guarda en SQLite&#10;   ```&#10;&#10;4. **Flow emite cambio automáticamente**&#10;   ```kotlin&#10;   // WeatherViewModel.kt (en init)&#10;   repository.getAllFavorites().collect { favorites -&gt;&#10;       _uiState.update { it.copy(favorites = favorites) }&#10;   }&#10;   // La UI se actualiza sola, sin llamar nada&#10;   ```&#10;&#10;---&#10;&#10;### ** ¿Por qué Jetpack Compose?**&#10;&#10;En lugar de XML tradicional, usamos **Jetpack Compose** (UI declarativa en Kotlin).&#10;&#10;**Ventajas:**&#10;- ✅ Menos código (50% menos que XML + Java/Kotlin)&#10;- ✅ Actualización automática (cuando el estado cambia, la UI se redibuja)&#10;- ✅ Animaciones fáciles (transiciones con pocas líneas)&#10;- ✅ Todo en Kotlin (no cambiar entre XML y código)&#10;- ✅ Live Preview en Android Studio&#10;&#10;**Ejemplo de Composable:**&#10;```kotlin&#10;@Composable&#10;fun Greeting(name: String) {&#10;    Text(&quot;Hola, $name!&quot;)  // Simplemente describes cómo se ve&#10;}&#10;```&#10;&#10;En lugar de:&#10;```xml&#10;&lt;!-- XML tradicional --&gt;&#10;&lt;TextView&#10;    android:id=&quot;@+id/textView&quot;&#10;    android:text=&quot;Hola, &quot; /&gt;&#10;```&#10;```kotlin&#10;// Kotlin tradicional&#10;textView.text = &quot;Hola, $name&quot;  // Imperativo: dices QUÉ hacer&#10;```&#10;&#10;---&#10;&#10;### ** Conceptos Clave del Código:**&#10;&#10;#### **StateFlow y Flow**&#10;- `StateFlow`: Observable que siempre tiene un valor actual&#10;- `Flow`: Stream de datos que puede emitir múltiples valores&#10;- La UI se suscribe y se actualiza automáticamente&#10;&#10;#### **Coroutines**&#10;- Hilos ligeros para operaciones asíncronas&#10;- `viewModelScope.launch { }`: Ejecuta en background&#10;- No bloquea la UI, mejor que Threads tradicionales&#10;&#10;#### **suspend fun**&#10;- Función que puede suspenderse sin bloquear&#10;- Solo se puede llamar desde coroutines&#10;- Ideal para operaciones de red o base de datos&#10;&#10;#### **Result&lt;T&gt;**&#10;- Kotlin estándar para manejar éxito/error&#10;- `Result.success(data)` o `Result.failure(exception)`&#10;- Más seguro que excepciones no manejadas&#10;&#10;#### **Sealed Classes y Data Classes**&#10;- `data class`: Clase para datos con equals, toString, copy&#10;- `sealed class`: Jerarquía cerrada, útil para estados&#10;&#10;---&#10;&#10;##  1. ¿Por qué aparece &quot;Monteros&quot; en lugar de &quot;Castilla&quot;?&#10;&#10;### **Explicación del Problema:**&#10;&#10;OpenWeatherMap API funciona con una base de datos de ciudades registradas. Cuando obtienes el clima por **coordenadas GPS**, la API busca en su base de datos la ciudad más cercana a esas coordenadas.&#10;&#10;**El problema es:**&#10;- Tu ubicación GPS puede estar en &quot;Castilla&quot;, pero en la base de datos de OpenWeatherMap, la ciudad registrada más cercana es &quot;Monteros&quot;&#10;- Esto es común en zonas rurales, pueblos pequeños, o áreas entre ciudades&#10;- La API de OpenWeatherMap tiene un número limitado de ciudades en su base de datos&#10;&#10;### **Soluciones:**&#10;&#10;#### **Opción 1: Buscar por nombre (Recomendado)**&#10;En lugar de usar tu ubicación GPS, busca directamente &quot;Castilla&quot; en el buscador de la app. Esto te dará los datos exactos de Castilla si está en la base de datos de OpenWeatherMap.&#10;&#10;#### **Opción 2: Usar el Mapa**&#10;Ve a la pestaña del mapa y selecciona manualmente un punto más cercano al centro de Castilla. Esto puede dar resultados diferentes.&#10;&#10;#### **Opción 3: Aceptar el nombre que da la API**&#10;Es técnicamente correcto que use &quot;Monteros&quot; si las coordenadas de tu GPS están más cerca de esa ciudad registrada. Los datos del clima serán igualmente precisos para tu área.&#10;&#10;### **Nota Técnica:**&#10;OpenWeatherMap tiene ~200,000 ciudades en su base de datos global. No todas las localidades pequeñas están incluidas. Si buscas &quot;Castilla&quot; y no aparece, significa que no está registrada en su sistema.&#10;&#10;---&#10;&#10;## ️ 2. ¿Por qué no carga el mapa?&#10;&#10;### **Causa del Problema:**&#10;&#10;El mapa de Google Maps necesita una **API Key válida** para funcionar. Si el mapa se ve:&#10;- **Gris/Vacío**: La API key no está configurada o es inválida&#10;- **Con mensaje de error**: La API no está habilitada o excediste el límite&#10;- **Sin marcadores**: Problema de permisos de ubicación&#10;&#10;### **Solución Paso a Paso:**&#10;&#10;#### **1. Obtén tu Google Maps API Key:**&#10;&#10;1. Ve a: https://console.cloud.google.com/&#10;2. Crea un proyecto nuevo (o usa uno existente)&#10;3. Ve a &quot;APIs &amp; Services&quot; &gt; &quot;Library&quot;&#10;4. Busca y habilita:&#10;   - **Maps SDK for Android**&#10;   - **Places API** (opcional, pero recomendado)&#10;5. Ve a &quot;APIs &amp; Services&quot; &gt; &quot;Credentials&quot;&#10;6. Crea una &quot;API Key&quot;&#10;7. **IMPORTANTE**: Restringe la key solo a tu app (por seguridad)&#10;&#10;#### **2. Configura la API Key en tu proyecto:**&#10;&#10;Abre el archivo `local.properties` (en la raíz del proyecto) y agrega:&#10;&#10;```properties&#10;GOOGLE_MAPS_API_KEY=AIzaSy... (tu key real aquí)&#10;OPENWEATHER_API_KEY=tu_key_de_openweather&#10;```&#10;&#10;#### **3. Sincroniza el proyecto:**&#10;&#10;En Android Studio:&#10;- Clic en &quot;Sync Now&quot; cuando aparezca el banner&#10;- O: `File &gt; Sync Project with Gradle Files`&#10;&#10;#### **4. Ejecuta de nuevo:**&#10;&#10;Desinstala la app del dispositivo y vuelve a instalarla para que tome la nueva configuración.&#10;&#10;### **Verificación:**&#10;&#10;Si todo está correcto, deberías ver:&#10;- ✅ El mapa de Google con calles y ubicaciones&#10;- ✅ Un marcador donde toques&#10;- ✅ Controles de zoom funcionando&#10;&#10;### **Límites de la API:**&#10;&#10;Google Maps es **GRATIS** hasta:&#10;- 28,000 cargas de mapa por mes&#10;- $200 USD de crédito gratis cada mes&#10;&#10;Para una app personal, nunca llegarás al límite.&#10;&#10;---&#10;&#10;## ⭐ 3. Prevención de Favoritos Duplicados (RESUELTO)&#10;&#10;### **Problema anterior:**&#10;Podías agregar la misma ciudad múltiples veces a favoritos.&#10;&#10;### **Solución implementada:**&#10;&#10;Ahora el sistema:&#10;1. **Verifica antes de agregar**: Comprueba si la ciudad ya existe en favoritos&#10;2. **Muestra mensaje claro**: &quot;⚠️ Esta ciudad ya está en tus favoritos&quot;&#10;3. **Compara por nombre**: Dos ubicaciones con el mismo nombre de ciudad se consideran duplicadas&#10;&#10;### **Código agregado:**&#10;```kotlin&#10;// En WeatherViewModel.kt&#10;fun addToFavorites(location: FavoriteLocation) {&#10;    viewModelScope.launch {&#10;        val isFav = repository.isFavorite(location.cityName)&#10;        if (isFav) {&#10;            _uiState.update {&#10;                it.copy(error = &quot;⚠️ Esta ciudad ya está en tus favoritos&quot;)&#10;            }&#10;            return@launch&#10;        }&#10;        // ... resto del código&#10;    }&#10;}&#10;```&#10;&#10;---&#10;&#10;##  4. Sugerencias de Búsqueda (NUEVO)&#10;&#10;### **Funcionalidad implementada:**&#10;&#10;Ahora mientras escribes en el buscador:&#10;- A partir de **2 caracteres**, aparecen sugerencias&#10;- Lista de **más de 80 ciudades** populares de España y Latinoamérica&#10;- Búsqueda **en tiempo real** mientras escribes&#10;- Filtra por coincidencias en el nombre de la ciudad&#10;&#10;### **Ciudades incluidas:**&#10;&#10;#### España:&#10;Madrid, Barcelona, Valencia, Sevilla, Zaragoza, Málaga, Murcia, Palma, Las Palmas, Bilbao, Alicante, Córdoba, Valladolid, Vigo, Gijón, Granada, Vitoria, Elche, Oviedo, Cartagena, Jerez, Sabadell, Almería, Pamplona, Castellón, Burgos, Santander, San Sebastián, Salamanca, Albacete, Logroño, León, Badajoz, Cádiz, Huelva, Tarragona, Lleida, Marbella&#10;&#10;#### Latinoamérica:&#10;Buenos Aires, Córdoba (AR), Rosario, Mendoza, México City, Guadalajara, Monterrey, Lima, Arequipa, Bogotá, Medellín, Cali, Santiago, Quito, Guayaquil, Caracas, La Paz, Montevideo, Asunción, San José, Panamá, Guatemala, San Salvador, Tegucigalpa, Managua, San Juan, Santo Domingo, La Habana, y más...&#10;&#10;### **Cómo funciona:**&#10;&#10;```kotlin&#10;// En WeatherRepository.kt&#10;fun searchCities(query: String): Result&lt;List&lt;String&gt;&gt; {&#10;    if (query.length &lt; 2) {&#10;        return Result.success(emptyList())&#10;    }&#10;    &#10;    val suggestions = getCitySuggestions(query)&#10;    return Result.success(suggestions)&#10;}&#10;```&#10;&#10;El sistema filtra las ciudades que contienen el texto que escribes y muestra las primeras 5 coincidencias.&#10;&#10;---&#10;&#10;##  Resumen de Mejoras Implementadas&#10;&#10;### ✅ **Validación de Favoritos**&#10;- No se pueden agregar ciudades duplicadas&#10;- Mensajes claros de error&#10;- Límite de 5 favoritos con contador visible&#10;&#10;### ✅ **Sistema de Sugerencias**&#10;- Búsqueda en tiempo real&#10;- Base de datos de 80+ ciudades&#10;- Respuesta instantánea (sin llamadas a API)&#10;&#10;### ✅ **Mejor UX**&#10;- Mensajes informativos para cada acción&#10;- Emojis para identificar rápidamente el estado&#10;- Animaciones suaves y transiciones&#10;&#10;### ✅ **Documentación Completa**&#10;- Explicación del problema de nombres de ciudades&#10;- Guía completa para configurar Google Maps&#10;- Solución de problemas comunes&#10;&#10;---&#10;&#10;##  Cómo Usar la App Actualizada&#10;&#10;1. **Primera vez:**&#10;   - Acepta los permisos de ubicación&#10;   - Se carga automáticamente el clima de tu ubicación actual&#10;&#10;2. **Buscar ciudades:**&#10;   - Escribe al menos 2 letras&#10;   - Aparecerán sugerencias automáticamente&#10;   - Selecciona una o presiona el botón de buscar&#10;&#10;3. **Agregar favoritos:**&#10;   - Presiona la ⭐ en la tarjeta del clima&#10;   - Máximo 5 ciudades&#10;   - No se permiten duplicados&#10;&#10;4. **Usar el mapa:**&#10;   - Ve a la pestaña &quot;Mapa&quot;&#10;   - Toca cualquier lugar del mapa&#10;   - Presiona &quot;Ver clima de esta ubicación&quot;&#10;   - Automáticamente te lleva a la vista del clima&#10;&#10;5. **Cambiar entre favoritos:**&#10;   - Toca cualquier tarjeta de favoritos&#10;   - Se carga instantáneamente el clima de esa ubicación&#10;&#10;---&#10;&#10;## ❓ Preguntas Frecuentes&#10;&#10;### **P: ¿Por qué el clima de mi ubicación no es exacto?**&#10;R: El GPS puede tener un margen de error de 5-50 metros. Para mayor precisión, busca tu ciudad por nombre.&#10;&#10;### **P: ¿Puedo agregar más de 5 favoritos?**&#10;R: No, el límite es 5 para mantener la interfaz limpia y rápida.&#10;&#10;### **P: ¿Las sugerencias funcionan offline?**&#10;R: Sí, las sugerencias están en el código. Pero para obtener el clima necesitas conexión a internet.&#10;&#10;### **P: ¿Por qué algunas ciudades pequeñas no aparecen?**&#10;R: OpenWeatherMap tiene ~200,000 ciudades. Si tu ciudad no está, usa las coordenadas del mapa.&#10;&#10;### **P: ¿Cuánto cuestan las APIs?**&#10;R: OpenWeatherMap Free Plan: GRATIS hasta 1,000,000 llamadas/mes&#10;   Google Maps: GRATIS con $200 USD crédito mensual&#10;&#10;---&#10;&#10;##  Soporte&#10;&#10;Si tienes más problemas:&#10;1. Verifica que las API keys estén correctamente en `local.properties`&#10;2. Sincroniza Gradle después de cualquier cambio&#10;3. Desinstala y reinstala la app si cambiaste las keys&#10;4. Verifica los permisos de ubicación en la configuración del dispositivo&#10;&#10;---&#10;&#10;**Última actualización:** Enero 2026&#10;**Versión de la app:** 1.0" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/README.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/README.md" />
              <option name="updatedContent" value="# Aplicación de Clima - Android&#10;&#10;Una aplicación completa de clima para Android desarrollada con Jetpack Compose que utiliza las APIs de OpenWeatherMap y Google Maps.&#10;&#10;## Características&#10;&#10;✅ **Búsqueda de ciudades**: Busca el clima de cualquier ciudad del mundo&#10;✅ **Ubicación actual**: Obtén el clima de tu ubicación actual con GPS&#10;✅ **Mapa interactivo**: Selecciona ubicaciones en un mapa para ver su clima&#10;✅ **Ubicaciones favoritas**: Guarda hasta 5 ubicaciones como favoritas&#10;✅ **Datos completos del clima**:&#10;  - Temperatura actual, mínima y máxima&#10;  - Sensación térmica&#10;  - Humedad y presión atmosférica&#10;  - Velocidad del viento&#10;  - Visibilidad y nubosidad&#10;  - Horas de amanecer y atardecer&#10;  - Coordenadas geográficas&#10;&#10;## Configuración&#10;&#10;### 1. Obtener las API Keys&#10;&#10;#### OpenWeatherMap API Key&#10;1. Visita [OpenWeatherMap](https://openweathermap.org/api)&#10;2. Crea una cuenta gratuita&#10;3. Ve a &quot;API Keys&quot; en tu perfil&#10;4. Copia tu API Key&#10;&#10;#### Google Maps API Key&#10;1. Visita [Google Cloud Console](https://console.cloud.google.com/)&#10;2. Crea un nuevo proyecto&#10;3. Habilita las siguientes APIs:&#10;   - Maps SDK for Android&#10;   - Places API&#10;4. Ve a &quot;Credenciales&quot; y crea una API Key&#10;5. Copia tu API Key&#10;&#10;### 2. Configurar las API Keys en el proyecto&#10;&#10;#### Para OpenWeatherMap:&#10;Abre el archivo `app/src/main/java/com/example/clima1/utils/Constants.kt` y reemplaza:&#10;```kotlin&#10;const val OPENWEATHER_API_KEY = &quot;TU_API_KEY_DE_OPENWEATHERMAP&quot;&#10;```&#10;&#10;#### Para Google Maps:&#10;Abre el archivo `app/build.gradle.kts` y reemplaza en la línea 19:&#10;```kotlin&#10;manifestPlaceholders[&quot;MAPS_API_KEY&quot;] = &quot;TU_GOOGLE_MAPS_API_KEY&quot;&#10;```&#10;&#10;### 3. Sincronizar y compilar&#10;&#10;1. Sincroniza el proyecto con Gradle&#10;2. Espera a que se descarguen todas las dependencias&#10;3. Compila y ejecuta la aplicación&#10;&#10;## Permisos requeridos&#10;&#10;La aplicación solicita los siguientes permisos:&#10;- **INTERNET**: Para obtener datos del clima&#10;- **ACCESS_FINE_LOCATION**: Para obtener tu ubicación precisa&#10;- **ACCESS_COARSE_LOCATION**: Para obtener tu ubicación aproximada&#10;&#10;## Tecnologías utilizadas&#10;&#10;- **Kotlin**: Lenguaje de programación&#10;- **Jetpack Compose**: UI moderna y declarativa&#10;- **Material Design 3**: Diseño moderno y consistente&#10;- **Retrofit**: Cliente HTTP para las APIs REST&#10;- **Room**: Base de datos local para favoritos&#10;- **Coroutines &amp; Flow**: Programación asíncrona&#10;- **Google Maps Compose**: Integración de mapas&#10;- **Coil**: Carga de imágenes&#10;- **MVVM Architecture**: Arquitectura limpia y mantenible&#10;&#10;## Estructura del proyecto&#10;&#10;```&#10;app/src/main/java/com/example/clima1/&#10;├── data/&#10;│   ├── local/          # Room Database&#10;│   ├── model/          # Modelos de datos&#10;│   ├── remote/         # API Services&#10;│   └── repository/     # Repositorio de datos&#10;├── ui/&#10;│   ├── screens/        # Pantallas de la app&#10;│   ├── theme/          # Tema y estilos&#10;│   └── viewmodel/      # ViewModels&#10;└── utils/              # Utilidades y constantes&#10;```&#10;&#10;## Uso de la aplicación&#10;&#10;### Pantalla Principal (Clima)&#10;- **Buscador**: Escribe el nombre de una ciudad y presiona el botón de enviar&#10;- **Ubicación actual**: Presiona el icono de ubicación en la barra superior&#10;- **Actualizar**: Presiona el icono de actualizar para refrescar los datos&#10;- **Favoritos**: Presiona la estrella para agregar la ubicación actual a favoritos&#10;- **Lista de favoritos**: Toca una tarjeta de favorito para ver su clima&#10;&#10;### Pantalla de Mapa&#10;- **Seleccionar ubicación**: Toca cualquier punto del mapa&#10;- **Ver clima**: Presiona el botón &quot;Obtener clima de esta ubicación&quot;&#10;- La app cambiará automáticamente a la pantalla de clima con los datos&#10;&#10;## Limitaciones&#10;&#10;- Máximo 5 ubicaciones favoritas&#10;- La API gratuita de OpenWeatherMap tiene un límite de 60 llamadas por minuto&#10;- Se requiere conexión a Internet para obtener datos del clima&#10;&#10;## Notas&#10;&#10;- Los datos del clima se muestran en español&#10;- Las temperaturas se muestran en grados Celsius&#10;- La velocidad del viento se muestra en metros por segundo&#10;&#10;## Soporte&#10;&#10;Si encuentras algún problema, verifica:&#10;1. Que las API Keys estén correctamente configuradas&#10;2. Que tengas conexión a Internet&#10;3. Que los permisos de ubicación estén otorgados&#10;4. Que las APIs estén habilitadas en tus consolas de desarrollo&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/build.gradle.kts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/build.gradle.kts" />
              <option name="originalContent" value="plugins {&#10;    alias(libs.plugins.android.application)&#10;    alias(libs.plugins.kotlin.android)&#10;    alias(libs.plugins.kotlin.compose)&#10;    alias(libs.plugins.ksp)&#10;}&#10;&#10;android {&#10;    namespace = &quot;com.example.clima1&quot;&#10;    compileSdk = 36&#10;&#10;    defaultConfig {&#10;        applicationId = &quot;com.example.clima1&quot;&#10;        minSdk = 24&#10;        targetSdk = 36&#10;        versionCode = 1&#10;        versionName = &quot;1.0&quot;&#10;&#10;        testInstrumentationRunner = &quot;androidx.test.runner.AndroidJUnitRunner&quot;&#10;&#10;        // Agrega tu API Key de Google Maps aquí&#10;        manifestPlaceholders[&quot;MAPS_API_KEY&quot;] = &quot;YOUR_GOOGLE_MAPS_API_KEY&quot;&#10;    }&#10;&#10;    buildTypes {&#10;        release {&#10;            isMinifyEnabled = false&#10;            proguardFiles(&#10;                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),&#10;                &quot;proguard-rules.pro&quot;&#10;            )&#10;        }&#10;    }&#10;    compileOptions {&#10;        sourceCompatibility = JavaVersion.VERSION_11&#10;        targetCompatibility = JavaVersion.VERSION_11&#10;    }&#10;    kotlinOptions {&#10;        jvmTarget = &quot;11&quot;&#10;    }&#10;    buildFeatures {&#10;        compose = true&#10;        buildConfig = true&#10;    }&#10;}&#10;&#10;dependencies {&#10;&#10;    implementation(libs.androidx.core.ktx)&#10;    implementation(libs.androidx.lifecycle.runtime.ktx)&#10;    implementation(libs.androidx.activity.compose)&#10;    implementation(platform(libs.androidx.compose.bom))&#10;    implementation(libs.androidx.compose.ui)&#10;    implementation(libs.androidx.compose.ui.graphics)&#10;    implementation(libs.androidx.compose.ui.tooling.preview)&#10;    implementation(libs.androidx.compose.material3)&#10;&#10;    // Retrofit&#10;    implementation(libs.retrofit)&#10;    implementation(libs.retrofit.gson)&#10;    implementation(libs.okhttp.logging)&#10;&#10;    // Coil for images&#10;    implementation(libs.coil.compose)&#10;&#10;    // Google Maps&#10;    implementation(libs.play.services.maps)&#10;    implementation(libs.play.services.location)&#10;    implementation(libs.maps.compose)&#10;&#10;    // Room&#10;    implementation(libs.room.runtime)&#10;    implementation(libs.room.ktx)&#10;    ksp(libs.room.compiler)&#10;&#10;    // ViewModel&#10;    implementation(libs.lifecycle.viewmodel.compose)&#10;&#10;    // Navigation&#10;    implementation(libs.navigation.compose)&#10;&#10;    // Permissions&#10;    implementation(libs.accompanist.permissions)&#10;&#10;    testImplementation(libs.junit)&#10;    androidTestImplementation(libs.androidx.junit)&#10;    androidTestImplementation(libs.androidx.espresso.core)&#10;    androidTestImplementation(platform(libs.androidx.compose.bom))&#10;    androidTestImplementation(libs.androidx.compose.ui.test.junit4)&#10;    debugImplementation(libs.androidx.compose.ui.tooling)&#10;    debugImplementation(libs.androidx.compose.ui.test.manifest)&#10;}" />
              <option name="updatedContent" value="import java.util.Properties&#10;&#10;plugins {&#10;    alias(libs.plugins.android.application)&#10;    alias(libs.plugins.kotlin.android)&#10;    alias(libs.plugins.kotlin.compose)&#10;    alias(libs.plugins.ksp)&#10;}&#10;&#10;android {&#10;    namespace = &quot;com.example.clima1&quot;&#10;    compileSdk = 36&#10;&#10;    defaultConfig {&#10;        applicationId = &quot;com.example.clima1&quot;&#10;        minSdk = 24&#10;        targetSdk = 36&#10;        versionCode = 1&#10;        versionName = &quot;1.0&quot;&#10;&#10;        testInstrumentationRunner = &quot;androidx.test.runner.AndroidJUnitRunner&quot;&#10;&#10;        // Leer las API keys desde local.properties&#10;        val localProperties = rootProject.file(&quot;local.properties&quot;)&#10;        val properties = Properties()&#10;        if (localProperties.exists()) {&#10;            properties.load(localProperties.inputStream())&#10;        }&#10;&#10;        // Obtener las API keys&#10;        val openWeatherApiKey = properties.getProperty(&quot;OPENWEATHER_API_KEY&quot;, &quot;&quot;)&#10;        val googleMapsApiKey = properties.getProperty(&quot;GOOGLE_MAPS_API_KEY&quot;, &quot;&quot;)&#10;&#10;        // Inyectar las API keys en BuildConfig&#10;        buildConfigField(&quot;String&quot;, &quot;OPENWEATHER_API_KEY&quot;, &quot;\&quot;$openWeatherApiKey\&quot;&quot;)&#10;        buildConfigField(&quot;String&quot;, &quot;GOOGLE_MAPS_API_KEY&quot;, &quot;\&quot;$googleMapsApiKey\&quot;&quot;)&#10;&#10;        // Agregar Google Maps API Key al manifest&#10;        manifestPlaceholders[&quot;MAPS_API_KEY&quot;] = googleMapsApiKey&#10;    }&#10;&#10;    buildTypes {&#10;        release {&#10;            isMinifyEnabled = false&#10;            proguardFiles(&#10;                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),&#10;                &quot;proguard-rules.pro&quot;&#10;            )&#10;        }&#10;    }&#10;    compileOptions {&#10;        sourceCompatibility = JavaVersion.VERSION_11&#10;        targetCompatibility = JavaVersion.VERSION_11&#10;    }&#10;    kotlinOptions {&#10;        jvmTarget = &quot;11&quot;&#10;    }&#10;    buildFeatures {&#10;        compose = true&#10;        buildConfig = true&#10;    }&#10;}&#10;&#10;dependencies {&#10;&#10;    implementation(libs.androidx.core.ktx)&#10;    implementation(libs.androidx.lifecycle.runtime.ktx)&#10;    implementation(libs.androidx.activity.compose)&#10;    implementation(platform(libs.androidx.compose.bom))&#10;    implementation(libs.androidx.compose.ui)&#10;    implementation(libs.androidx.compose.ui.graphics)&#10;    implementation(libs.androidx.compose.ui.tooling.preview)&#10;    implementation(libs.androidx.compose.material3)&#10;&#10;    // Retrofit&#10;    implementation(libs.retrofit)&#10;    implementation(libs.retrofit.gson)&#10;    implementation(libs.okhttp.logging)&#10;&#10;    // Coil for images&#10;    implementation(libs.coil.compose)&#10;&#10;    // Google Maps&#10;    implementation(libs.play.services.maps)&#10;    implementation(libs.play.services.location)&#10;    implementation(libs.maps.compose)&#10;&#10;    // Coroutines para Google Play Services&#10;    implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-play-services:1.7.3&quot;)&#10;&#10;    // Room&#10;    implementation(libs.room.runtime)&#10;    implementation(libs.room.ktx)&#10;    ksp(libs.room.compiler)&#10;&#10;    // ViewModel&#10;    implementation(libs.lifecycle.viewmodel.compose)&#10;&#10;    // Navigation&#10;    implementation(libs.navigation.compose)&#10;&#10;    // Permissions&#10;    implementation(libs.accompanist.permissions)&#10;&#10;    testImplementation(libs.junit)&#10;    androidTestImplementation(libs.androidx.junit)&#10;    androidTestImplementation(libs.androidx.espresso.core)&#10;    androidTestImplementation(platform(libs.androidx.compose.bom))&#10;    androidTestImplementation(libs.androidx.compose.ui.test.junit4)&#10;    debugImplementation(libs.androidx.compose.ui.tooling)&#10;    debugImplementation(libs.androidx.compose.ui.test.manifest)&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/AndroidManifest.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/AndroidManifest.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;application&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:theme=&quot;@style/Theme.Clima1&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&#10;            android:label=&quot;@string/app_name&quot;&#10;            android:theme=&quot;@style/Theme.Clima1&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#13;&#10;&#13;&#10;    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;&#13;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot; /&gt;&#13;&#10;    &lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;application&#13;&#10;        android:allowBackup=&quot;true&quot;&#13;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#13;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#13;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#13;&#10;        android:label=&quot;@string/app_name&quot;&#13;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#13;&#10;        android:supportsRtl=&quot;true&quot;&#13;&#10;        android:theme=&quot;@style/Theme.Clima1&quot;&gt;&#13;&#10;        &#13;&#10;        &lt;meta-data&#13;&#10;            android:name=&quot;com.google.android.geo.API_KEY&quot;&#13;&#10;            android:value=&quot;${MAPS_API_KEY}&quot; /&gt;&#13;&#10;        &#13;&#10;        &lt;activity&#13;&#10;            android:name=&quot;.MainActivity&quot;&#13;&#10;            android:exported=&quot;true&quot;&#13;&#10;            android:label=&quot;@string/app_name&quot;&#13;&#10;            android:theme=&quot;@style/Theme.Clima1&quot;&gt;&#13;&#10;            &lt;intent-filter&gt;&#13;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#13;&#10;&#13;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#13;&#10;            &lt;/intent-filter&gt;&#13;&#10;        &lt;/activity&gt;&#13;&#10;    &lt;/application&gt;&#13;&#10;&#13;&#10;&lt;/manifest&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/clima1/utils/LocationUtils.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/clima1/utils/LocationUtils.kt" />
              <option name="updatedContent" value="package com.example.clima1.utils&#10;&#10;import android.Manifest&#10;import android.content.Context&#10;import android.location.Location&#10;import androidx.compose.runtime.*&#10;import com.google.accompanist.permissions.*&#10;import com.google.android.gms.location.LocationServices&#10;import com.google.android.gms.location.Priority&#10;import com.google.android.gms.tasks.CancellationTokenSource&#10;import kotlinx.coroutines.tasks.await&#10;&#10;@OptIn(ExperimentalPermissionsApi::class)&#10;@Composable&#10;fun RequestLocationPermission(&#10;    onPermissionGranted: () -&gt; Unit,&#10;    onPermissionDenied: () -&gt; Unit&#10;) {&#10;    val locationPermissionsState = rememberMultiplePermissionsState(&#10;        listOf(&#10;            Manifest.permission.ACCESS_FINE_LOCATION,&#10;            Manifest.permission.ACCESS_COARSE_LOCATION&#10;        )&#10;    )&#10;    &#10;    LaunchedEffect(locationPermissionsState.allPermissionsGranted) {&#10;        if (locationPermissionsState.allPermissionsGranted) {&#10;            onPermissionGranted()&#10;        }&#10;    }&#10;    &#10;    if (!locationPermissionsState.allPermissionsGranted) {&#10;        LaunchedEffect(Unit) {&#10;            locationPermissionsState.launchMultiplePermissionRequest()&#10;        }&#10;    }&#10;}&#10;&#10;suspend fun getCurrentLocation(context: Context): Location? {&#10;    return try {&#10;        val fusedLocationClient = LocationServices.getFusedLocationProviderClient(context)&#10;        val cancellationTokenSource = CancellationTokenSource()&#10;        &#10;        fusedLocationClient.getCurrentLocation(&#10;            Priority.PRIORITY_HIGH_ACCURACY,&#10;            cancellationTokenSource.token&#10;        ).await()&#10;    } catch (e: SecurityException) {&#10;        null&#10;    } catch (e: Exception) {&#10;        null&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>